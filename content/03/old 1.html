
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Outline &#8212; LeDataSciFi-2021</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fin377_specialformatting.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">LeDataSciFi-2021</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  About the class
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../about/objectives.html">
   Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/outcomes.html">
   Outcomes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/about_us.html">
   About us + office hours
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/structure_and_policies.html">
   Course structure + policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/gradeoverview.html">
   Grading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/acknowledgments.html">
   Gratitude
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Schedule, tips, resources
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../about/schedule.html">
   Dashboard, key links, schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/resources.html">
   Help + resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/tips.html">
   Tips and hacks
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Assignments and participation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/howto_do.html">
   How to start and turn in assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/howto_review.html">
   How to do your peer reviews
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Textbook
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../01/00_Getting_Started.html">
   1. Motivation and Getting Started
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../01/01_Motivation.html">
     1.1. Motivation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/02_Setup.html">
     1.2. Set up
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/03_github.html">
     1.3. Github Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/04_Markdown.html">
     1.4. Markdown basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/05_jupyterlab.html">
     1.5. Jupyter Lab Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/06_python.html">
     1.6. Python Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/07_debugging.html">
     1.7. Debugging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/08_libraries.html">
     1.8. Installing libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/09_gitignore.html">
     1.9. Gitignore Files
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../02/10_Golden_1.html">
   2. Good Analysis Practices
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../02/10_Golden_2.html">
     2.1. A case study of bad research
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/10_Golden_3.html">
     2.2. The golden rules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/10_Golden_4.html">
     2.3. Good data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/10_Golden_5.html">
     2.4. When to write functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/10_Golden_6.html">
     2.5. Reorganizing the bad research folder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/10_Golden_7.html">
     2.6. Filepaths
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="00_Data_Wrangling_Intro.html">
   3. Wrangling with Data
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="01a_NumpyCS.html">
     3.1. Numpy - Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01b_NumpyBasics.html">
     3.2. Numpy - Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01c_NumpyPractice.html">
     3.3. Numpy - Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01d_NumpyResources.html">
     3.4. Numpy - More Resources
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/03/old 1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/LeDataSciFi/ledatascifi-2021"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/LeDataSciFi/ledatascifi-2021/issues/new?title=Issue%20on%20page%20%2Fcontent/03/old 1.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/LeDataSciFi/ledatascifi-2021/edit/main/content/03/old 1.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/LeDataSciFi/ledatascifi-2021/main?urlpath=lab/tree/content/03/old 1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/LeDataSciFi/ledatascifi-2021/blob/main/content/03/old 1.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Outline
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-essential-data-wrangling-toolkit">
   The essential data wrangling toolkit
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#essential-pandas-manipulating-data">
     Essential
     <code class="docutils literal notranslate">
      <span class="pre">
       pandas
      </span>
     </code>
     : Manipulating data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temp-vs-permanent-methods">
     Temp vs. Permanent Methods
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#essential-pandas-statistical-operations">
     Essential
     <code class="docutils literal notranslate">
      <span class="pre">
       pandas
      </span>
     </code>
     : Statistical operations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#essential-pandas-exploring-the-dataset">
     Essential
     <code class="docutils literal notranslate">
      <span class="pre">
       pandas
      </span>
     </code>
     : Exploring the dataset
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#game-of-thrones-example-slicing-group-stats-and-plotting">
     Game of Thrones example - slicing, group stats, and plotting
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#version-1">
       Version 1
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#version-2-query-loc-for-readability">
       Version 2 -
       <code class="docutils literal notranslate">
        <span class="pre">
         query
        </span>
       </code>
       &gt;
       <code class="docutils literal notranslate">
        <span class="pre">
         loc
        </span>
       </code>
       , for readability
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#version-3-method-chaining">
       Version 3 - Method chaining!
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cookbook-and-best-practices-a-starter-kit">
   Cookbook and best practices (a starter kit)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-analysis-steps-and-comments">
     General analysis steps and comments
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-summary-tables">
     Creating summary tables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-summary-plots">
     Creating summary plots
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#time-to-practice">
   Time to practice
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#before-next-class">
   Before next class
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#credits">
   Credits
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="outline">
<h1>Outline<a class="headerlink" href="#outline" title="Permalink to this headline">¶</a></h1>
<ol class="simple">
<li><p>Be patient and persistent: keep going when the scope of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and your first data analysis exercises stump you!</p></li>
<li><p>Essential functions for data wrangling, statistics, and exploration</p></li>
<li><p>Example: Data wrangling and exploration that is readable and powerful</p></li>
<li><p>Cookbook: Typical data analysis steps, table creation, and figures</p></li>
</ol>
</div>
<div class="section" id="the-essential-data-wrangling-toolkit">
<h1>The essential data wrangling toolkit<a class="headerlink" href="#the-essential-data-wrangling-toolkit" title="Permalink to this headline">¶</a></h1>
<p>I imagine you’ll return to this page a lot. Today and tomorrow,</p>
<ol class="simple">
<li><p>I’m going to make note of a few important tools we have available</p></li>
<li><p>I’ll show you an example that illustrates how those tools can be applied</p></li>
<li><p>We’ll practice together</p></li>
<li><p>You’ll be in position to attack ASGN 02</p></li>
<li><p>Over time and with experience, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> will become less overwhelming and more of a friend!</p></li>
</ol>
<p>Note 1: “<code class="docutils literal notranslate"><span class="pre">df</span></code>” is often used as a name of a generic dataframe in examples. Generally, you should
give your dataframes better names!</p>
<p>Note 2: There are other ways to do many of these operations. For example (the sidebar illustrates)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df['feet']=df['height']//12</span></code> will create a new column called feet</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df[['gender','height']]</span></code> will return just those two columns-</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.loc[df['feet']==5,'feet']</span> <span class="pre">=</span> <span class="pre">np.nan</span></code> will overwrite the feet variable only when feet equals 5</p></li>
<li><p>More on indexing and selection <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.02-data-indexing-and-selection.html">here</a>—highly recommend! If that link is dead: <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.02-data-indexing-and-selection.html">https://jakevdp.github.io/PythonDataScienceHandbook/03.02-data-indexing-and-selection.html</a></p></li>
</ul>
<div class="cell tag_popout docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># everyone imports pandas as pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;height&#39;</span><span class="p">:[</span><span class="mi">72</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">68</span><span class="p">],</span><span class="s1">&#39;gender&#39;</span><span class="p">:[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">],</span><span class="s1">&#39;weight&#39;</span><span class="p">:[</span><span class="mi">175</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">150</span><span class="p">]})</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;feet&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">//</span><span class="mi">12</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2"> Original df:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">df</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2"> Subset of vars:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span><span class="s1">&#39;height&#39;</span><span class="p">]])</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;feet&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;feet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2"> Replace given condition:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Original df:
    height gender  weight  feet
0      72      M     175     6
1      60      F     110     5
2      68      M     150     5


 Subset of vars:
   gender  height
0      M      72
1      F      60
2      M      68


 Replace given condition:
    height gender  weight  feet
0      72      M     175   6.0
1      60      F     110   NaN
2      68      M     150   NaN
</pre></div>
</div>
</div>
</div>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<div class="section" id="essential-pandas-manipulating-data">
<h2>Essential <code class="docutils literal notranslate"><span class="pre">pandas</span></code>: Manipulating data<a class="headerlink" href="#essential-pandas-manipulating-data" title="Permalink to this headline">¶</a></h2>
<p>Try to notice, throughout this lecture, when methods operate on specific DataFrames (e.g. <code class="docutils literal notranslate"><span class="pre">assign</span></code>)  and when methods are a called on the pandas module itself (e.g. <code class="docutils literal notranslate"><span class="pre">pd.merge</span></code>). <em>Generally,</em> methods that work outside a single DataFrame (the load data or work on multiple datasets) are called via <code class="docutils literal notranslate"><span class="pre">pd.&lt;method&gt;</span></code> while methods that work on a single DataFrame are called via <code class="docutils literal notranslate"><span class="pre">&lt;dfname&gt;.&lt;method&gt;</span></code>.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Function</p></th>
<th class="text-align:left head"><p>Pandas method</p></th>
<th class="text-align:left head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>new variables or replace existing</p></td>
<td class="text-align:left"><p>assign</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.assign(feet=df['height']//12)</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>get subset of columns</p></td>
<td class="text-align:left"><p>filter</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.filter(['height','weight'])</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>rename columns</p></td>
<td class="text-align:left"><p>rename</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.rename(columns={&quot;height&quot;:</span> <span class="pre">&quot;how</span> <span class="pre">tall&quot;})</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>get subset of observations  <br> or, “drop rows”</p></td>
<td class="text-align:left"><p>query /  loc / iloc</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.query('height</span> <span class="pre">&gt;</span> <span class="pre">68')</span></code>    <br> <code class="docutils literal notranslate"><span class="pre">df.loc[df['gender']=='F']</span></code>   <br> <code class="docutils literal notranslate"><span class="pre">df.iloc[1:]</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>sort</p></td>
<td class="text-align:left"><p>sort_values</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.sort_values(['gender','weight'])</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>create groups</p></td>
<td class="text-align:left"><p>groupby</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.groupby(['gender'])</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>summary stats on groups</p></td>
<td class="text-align:left"><p>agg / pivot_table</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.groupby(['gender'])</span></code> <br> <code class="docutils literal notranslate"><span class="pre">.agg({'height':[max,min,np.mean]})</span></code> <br> <br> <code class="docutils literal notranslate"><span class="pre">df.pivot_table(index='age',</span> <span class="pre">columns='age',</span> <span class="pre">values='weight'</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>create a variable based on its group</p></td>
<td class="text-align:left"><p>agg+transform</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.groupby(['industry','year'])['leverage'].mean().transform()</span></code> <br> will add industry average leverage to your dataset for each firm</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>delete column</p></td>
<td class="text-align:left"><p>drop</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.drop(columns=['gender'])</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>use non-pd function on df</p></td>
<td class="text-align:left"><p>pipe</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.pipe((sns.lineplot,data),x=x,y=y)</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>combine dataframes</p></td>
<td class="text-align:left"><p>merge</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">pd.merge(df1,df2)</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><strong>RESHAPE:</strong> convert wide to long/tall (“stack!”)</p></td>
<td class="text-align:left"><p>stack</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.stack()</span></code>, see popout</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>… another option to reshape tall:</p></td>
<td class="text-align:left"><p>melt</p></td>
<td class="text-align:left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><strong>RESHAPE:</strong> convert long/tall to wide (“unstack!”)</p></td>
<td class="text-align:left"><p>unstack</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.unstack()</span></code>, see popout</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>… another option to reshape wide:</p></td>
<td class="text-align:left"><p>pivot / pivot_table</p></td>
<td class="text-align:left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>change time frequency of data</p></td>
<td class="text-align:left"><p>resample</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df.resample('Y').mean()</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>loading data</p></td>
<td class="text-align:left"><p>read_csv, read_dta, etc</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">pd.read_csv('wine.csv')</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>window/rolling calculations</p></td>
<td class="text-align:left"><p>window</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">df['vol_5yr']=</span> <span class="pre">df.groupby('firm').rolling(36).var('ret').transform()</span></code> will add 36 period volatility for each firm</p></td>
</tr>
</tbody>
</table>
<p>When you wonder about syntax, and arguments, you can either go to the official documentation on the web, or rely on Jupyter’s tab auto completion.</p>
<p><strong>Here is a fun trick: <code class="docutils literal notranslate"><span class="pre">SHIFT+TAB</span></code>!</strong> Try it! Type <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">pandas</span> <span class="pre">as</span> <span class="pre">pd</span></code> then run that to load pandas. Then type <code class="docutils literal notranslate"><span class="pre">pd.merge(</span></code> like you want to merge to dataframes, except you don’t remember the arguments to use. So type <code class="docutils literal notranslate"><span class="pre">SHIFT+TAB+TAB</span></code>. <em>1 TAB opens a little syntax screen, 2 opens a larger amount of syntax info, and 3 opens the whole help file at the bottom of the screen.</em> I’ve personally moved to <code class="docutils literal notranslate"><span class="pre">SHIFT+TAB</span></code> for help most of the time (instead of <code class="docutils literal notranslate"><span class="pre">help()</span></code> or <code class="docutils literal notranslate"><span class="pre">?</span></code>).</p>
<div class="cell tag_popout docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># AN ASIDE ON RESHAPING</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>   <span class="p">(</span><span class="s1">&#39;Ford&#39;</span><span class="p">,</span><span class="mi">2000</span><span class="p">):</span><span class="mi">10</span><span class="p">,</span>
                   <span class="p">(</span><span class="s1">&#39;Ford&#39;</span><span class="p">,</span><span class="mi">2001</span><span class="p">):</span><span class="mi">12</span><span class="p">,</span>
                   <span class="p">(</span><span class="s1">&#39;Ford&#39;</span><span class="p">,</span><span class="mi">2002</span><span class="p">):</span><span class="mi">14</span><span class="p">,</span>
                   <span class="p">(</span><span class="s1">&#39;Ford&#39;</span><span class="p">,</span><span class="mi">2003</span><span class="p">):</span><span class="mi">16</span><span class="p">,</span>
                   <span class="p">(</span><span class="s1">&#39;GM&#39;</span><span class="p">,</span><span class="mi">2000</span><span class="p">):</span><span class="mi">11</span><span class="p">,</span>
                   <span class="p">(</span><span class="s1">&#39;GM&#39;</span><span class="p">,</span><span class="mi">2001</span><span class="p">):</span><span class="mi">13</span><span class="p">,</span>
                   <span class="p">(</span><span class="s1">&#39;GM&#39;</span><span class="p">,</span><span class="mi">2002</span><span class="p">):</span><span class="mi">13</span><span class="p">,</span>
                   <span class="p">(</span><span class="s1">&#39;GM&#39;</span><span class="p">,</span><span class="mi">2003</span><span class="p">):</span><span class="mi">15</span><span class="p">})</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;Sales&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">([</span><span class="s1">&#39;Firm&#39;</span><span class="p">,</span><span class="s1">&#39;Year&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">df</span><span class="p">)</span>
<span class="n">wide</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Unstack (make it shorter+wider)</span><span class="se">\n</span><span class="s2">on level 0/Firm:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">wide</span><span class="p">)</span> <span class="c1"># move index level 0 (firm name) to column</span>
<span class="n">tall</span> <span class="o">=</span> <span class="n">wide</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Stack it back (make it tall):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">tall</span><span class="p">)</span> <span class="c1"># move index level 0 (firm name) to column</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Stack it back and reorder </span><span class="se">\n</span><span class="s2">index as before (firm-year):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">tall</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Unstack level 1/Year:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># move index level 0 (firm name) to column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original:
            Sales
Firm Year       
Ford 2000     10
     2001     12
     2002     14
     2003     16
GM   2000     11
     2001     13
     2002     13
     2003     15


Unstack (make it shorter+wider)
on level 0/Firm:
      Sales    
Firm  Ford  GM
Year          
2000    10  11
2001    12  13
2002    14  13
2003    16  15


Stack it back (make it tall):
            Sales
Year Firm       
2000 Ford     10
     GM       11
2001 Ford     12
     GM       13
2002 Ford     14
     GM       13
2003 Ford     16
     GM       15


Stack it back and reorder 
index as before (firm-year):
            Sales
Firm Year       
Ford 2000     10
     2001     12
     2002     14
     2003     16
GM   2000     11
     2001     13
     2002     13
     2003     15


Unstack level 1/Year:
      Sales               
Year  2000 2001 2002 2003
Firm                     
Ford    10   12   14   16
GM      11   13   13   15
</pre></div>
</div>
</div>
</div>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
</div>
<div class="section" id="temp-vs-permanent-methods">
<h2>Temp vs. Permanent Methods<a class="headerlink" href="#temp-vs-permanent-methods" title="Permalink to this headline">¶</a></h2>
<p>This is generally true with python but I’ll reiterate here:
Using methods on an object (e.g. a DataFrame) will give you an
object with the method applied, as you
can see here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define a df</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;height&#39;</span><span class="p">:[</span><span class="mi">72</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">68</span><span class="p">],</span><span class="s1">&#39;gender&#39;</span><span class="p">:[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">],</span><span class="s1">&#39;weight&#39;</span><span class="p">:[</span><span class="mi">175</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">150</span><span class="p">]})</span>
<span class="c1"># call method on df and print</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">feet</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">//</span><span class="mi">12</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   height gender  weight  feet
0      72      M     175     6
1      60      F     110     5
2      68      M     150     5
</pre></div>
</div>
</div>
</div>
<p>Which is useful if you want to
alter the variable <strong>temporarily</strong>
(e.g. for a graph, or to just
print it out, like I literally
just did!).</p>
<p><strong>But the object in memory wasn’t
changed when I used <code class="docutils literal notranslate"><span class="pre">df.&lt;method&gt;</span></code>. See, here is the df in memory:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>  <span class="c1"># see, no feet!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   height gender  weight
0      72      M     175
1      60      F     110
2      68      M     150
</pre></div>
</div>
</div>
</div>
<p><strong>If you want to change the object permanently, you have three
options:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># option 1: explicitly define the df as the prior df after the method was called</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">feet1</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">//</span><span class="mi">12</span><span class="p">)</span> 

<span class="c1"># option 2: define a new feature of the df</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;feet2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">//</span><span class="mi">12</span>

<span class="c1"># option 3: some methods have an &quot;inplace&quot; option so you don&#39;t need to write &quot;df = ...&quot;</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="c1"># feet1 and feet 2 added to obj in memory, gender dropped</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   height  weight  feet1  feet2
0      72     175      6      6
1      60     110      5      5
2      68     150      5      5
</pre></div>
</div>
</div>
</div>
<p>Generally, option 2 &gt; 1 (it is easier to read), but you’ll need to use option 1 when you’re method chaining.</p>
</div>
<div class="section" id="essential-pandas-statistical-operations">
<h2>Essential <code class="docutils literal notranslate"><span class="pre">pandas</span></code>: Statistical operations<a class="headerlink" href="#essential-pandas-statistical-operations" title="Permalink to this headline">¶</a></h2>
<p>These functions can be called for a variable “col1” in this form: <code class="docutils literal notranslate"><span class="pre">df['col1'].&lt;function&gt;()</span></code> or for all numerical columns at once using <code class="docutils literal notranslate"><span class="pre">df.&lt;function&gt;()</span></code>.</p>
<p><strong>ALSO:</strong> These functions work within groups.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>count</p></td>
<td><p>Number of non-null observations</p></td>
</tr>
<tr class="row-odd"><td><p>sum</p></td>
<td><p>Sum of values</p></td>
</tr>
<tr class="row-even"><td><p>mean</p></td>
<td><p>Mean of values</p></td>
</tr>
<tr class="row-odd"><td><p>mad</p></td>
<td><p>Mean absolute deviation</p></td>
</tr>
<tr class="row-even"><td><p>median</p></td>
<td><p>Arithmetic median of values</p></td>
</tr>
<tr class="row-odd"><td><p>min</p></td>
<td><p>Minimum</p></td>
</tr>
<tr class="row-even"><td><p>max</p></td>
<td><p>Maximum</p></td>
</tr>
<tr class="row-odd"><td><p>mode</p></td>
<td><p>Mode</p></td>
</tr>
<tr class="row-even"><td><p>abs</p></td>
<td><p>Absolute Value</p></td>
</tr>
<tr class="row-odd"><td><p>prod</p></td>
<td><p>Product of values</p></td>
</tr>
<tr class="row-even"><td><p>std</p></td>
<td><p>Unbiased standard deviation</p></td>
</tr>
<tr class="row-odd"><td><p>var</p></td>
<td><p>Unbiased variance</p></td>
</tr>
<tr class="row-even"><td><p>sem</p></td>
<td><p>Unbiased standard error of the mean</p></td>
</tr>
<tr class="row-odd"><td><p>skew</p></td>
<td><p>Unbiased skewness (3rd moment)</p></td>
</tr>
<tr class="row-even"><td><p>kurt</p></td>
<td><p>Unbiased kurtosis (4th moment)</p></td>
</tr>
<tr class="row-odd"><td><p>quantile</p></td>
<td><p>Sample quantile (value at %)</p></td>
</tr>
<tr class="row-even"><td><p>cumsum</p></td>
<td><p>Cumulative sum</p></td>
</tr>
<tr class="row-odd"><td><p>cumprod</p></td>
<td><p>Cumulative product</p></td>
</tr>
<tr class="row-even"><td><p>cummax</p></td>
<td><p>Cumulative maximum</p></td>
</tr>
<tr class="row-odd"><td><p>cummin</p></td>
<td><p>Cumulative minimum</p></td>
</tr>
<tr class="row-even"><td><p>nunique</p></td>
<td><p>How many unique values?</p></td>
</tr>
<tr class="row-odd"><td><p>value_counts</p></td>
<td><p>How many of each unique value are there?</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="essential-pandas-exploring-the-dataset">
<h2>Essential <code class="docutils literal notranslate"><span class="pre">pandas</span></code>: Exploring the dataset<a class="headerlink" href="#essential-pandas-exploring-the-dataset" title="Permalink to this headline">¶</a></h2>
<p>You should <strong>always, always, always</strong> open your datasets up to physically (digitally?) look at them and then also generate summary statistics:</p>
<ol class="simple">
<li><p>Print the first and last five rows: <code class="docutils literal notranslate"><span class="pre">df.head()</span></code> and <code class="docutils literal notranslate"><span class="pre">df.tail()</span></code></p></li>
<li><p>What is the shape of the data? <code class="docutils literal notranslate"><span class="pre">df.shape</span></code></p></li>
<li><p>How much memory does it take, and what are the variable names/types? <code class="docutils literal notranslate"><span class="pre">df.info()</span></code></p></li>
<li><p>Summary stats on variables: <code class="docutils literal notranslate"><span class="pre">df.describe()</span></code>, <code class="docutils literal notranslate"><span class="pre">df.value_counts[:10]</span></code>, and <code class="docutils literal notranslate"><span class="pre">df['var'].nunique()</span></code></p></li>
</ol>
<p>Consider these <strong>Golden Rules</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import a famous dataset, seaborn nicely contains it out of the box!</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> 
<span class="n">iris</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">)</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">The shape is: &quot;</span><span class="p">,</span><span class="n">iris</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Info:&quot;</span><span class="p">,</span><span class="n">iris</span><span class="o">.</span><span class="n">info</span><span class="p">())</span> <span class="c1"># memory usage, name, dtype, and # of non-null obs (--&gt; # of missing obs) per variable</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span> <span class="c1"># summary stats, and you can customize the list!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   sepal_length  sepal_width  petal_length  petal_width species
0           5.1          3.5           1.4          0.2  setosa
1           4.9          3.0           1.4          0.2  setosa
2           4.7          3.2           1.3          0.2  setosa
3           4.6          3.1           1.5          0.2  setosa
4           5.0          3.6           1.4          0.2  setosa
     sepal_length  sepal_width  petal_length  petal_width    species
145           6.7          3.0           5.2          2.3  virginica
146           6.3          2.5           5.0          1.9  virginica
147           6.5          3.0           5.2          2.0  virginica
148           6.2          3.4           5.4          2.3  virginica
149           5.9          3.0           5.1          1.8  virginica


The shape is:  (150, 5)
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 150 entries, 0 to 149
Data columns (total 5 columns):
sepal_length    150 non-null float64
sepal_width     150 non-null float64
petal_length    150 non-null float64
petal_width     150 non-null float64
species         150 non-null object
dtypes: float64(4), object(1)
memory usage: 6.0+ KB


Info: None
       sepal_length  sepal_width  petal_length  petal_width
count    150.000000   150.000000    150.000000   150.000000
mean       5.843333     3.057333      3.758000     1.199333
std        0.828066     0.435866      1.765298     0.762238
min        4.300000     2.000000      1.000000     0.100000
25%        5.100000     2.800000      1.600000     0.300000
50%        5.800000     3.000000      4.350000     1.300000
75%        6.400000     3.300000      5.100000     1.800000
max        7.900000     4.400000      6.900000     2.500000
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="game-of-thrones-example-slicing-group-stats-and-plotting">
<h2>Game of Thrones example - slicing, group stats, and plotting<a class="headerlink" href="#game-of-thrones-example-slicing-group-stats-and-plotting" title="Permalink to this headline">¶</a></h2>
<p>I didn’t find an off the shelf dataset to run our seminal analysis from last week, but I found <a class="reference external" href="https://www.kaggle.com/dhanushkishore/impact-of-game-of-thrones-on-us-baby-names">an analysis</a> that explored if Game of Thrones prompted parents to start naming their children differently. The following is inspired by that, but uses pandas to acquire and wrangle our data in a “Tidyverse”-style (how R would do it) flow.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#TO USE datadotworld PACKAGE:</span>
<span class="c1">#1. create account at data.world, then run the next two lines:</span>
<span class="c1">#2. in terminal/powershell: pip install datadotworld[pandas]</span>
<span class="c1">#</span>
<span class="c1">#   IF THIS DOESN&#39;T WORK BC YOU GET AN ERROR ABOUT &quot;CCHARDET&quot;, RUN:</span>
<span class="c1">#    conda install -c conda-forge cchardet</span>
<span class="c1">#   THEN RERUN: pip install datadotworld[pandas] </span>
<span class="c1">#</span>
<span class="c1">#3. in terminal/powershell: dw configure          </span>
<span class="c1">#3a. copy in API token from data.world (get from settings &gt; advanced)</span>

<span class="kn">import</span> <span class="nn">datadotworld</span> <span class="k">as</span> <span class="nn">dw</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">baby_names</span> <span class="o">=</span> <span class="n">dw</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;nkrishnaswami/us-ssa-baby-names-national&#39;</span><span class="p">)</span>
<span class="n">baby_names</span> <span class="o">=</span> <span class="n">baby_names</span><span class="o">.</span><span class="n">dataframes</span><span class="p">[</span><span class="s1">&#39;names_ranks_counts&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="version-1">
<h3>Version 1<a class="headerlink" href="#version-1" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>save a slice of the dataset with the names we want (using <code class="docutils literal notranslate"><span class="pre">.loc</span></code>)</p></li>
<li><p>sometimes a name is used by boys and girls in the same year, so combine the counts so that we have one observation per name per year</p></li>
<li><p>save the dataset and then call a plot function</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># restrict by name and only keep years after 2000</span>
<span class="n">somenames</span> <span class="o">=</span> <span class="n">baby_names</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span> <span class="c1"># formating inside this () is just to make it clearer to a reader</span>
    <span class="p">(</span> <span class="c1"># condition 1: one of these names, | means &quot;or&quot;</span>
        <span class="p">(</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Sansa&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Daenerys&quot;</span><span class="p">)</span> <span class="o">|</span> 
        <span class="p">(</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Brienne&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Cersei&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Tyrion&quot;</span><span class="p">)</span> 
    <span class="p">)</span> <span class="c1"># end condition 1</span>
    <span class="o">&amp;</span> <span class="c1"># &amp; means &quot;and&quot;</span>
    <span class="p">(</span> <span class="c1"># condition 2: these years</span>
        <span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2000</span><span class="p">)</span> <span class="c1"># end condition 2</span>
    <span class="p">)]</span>

<span class="c1"># if a name is used by F and M in a given year, combine the count variable</span>
<span class="c1"># Q: why is there a &quot;reset_index&quot;? </span>
<span class="c1"># A: groupby automatically turns the groups (here name and year) into the index</span>
<span class="c1">#    reset_index makes the index simple integers 0, 1, 2 and also</span>
<span class="c1">#    turns the the grouping variables back into normal columns</span>
<span class="c1"># A2: instead of reset_index, you can include `as_index=False` inside groupby!</span>
<span class="c1">#     (I just learned that myself!)</span>
<span class="n">somenames_agg</span> <span class="o">=</span> <span class="n">somenames</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">])[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>

<span class="c1"># plot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">somenames_agg</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="c1"># add a line for when the show debuted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x2dd2103ad48&gt;
</pre></div>
</div>
<img alt="../../_images/old 1_18_1.png" src="../../_images/old 1_18_1.png" />
</div>
</div>
</div>
<div class="section" id="version-2-query-loc-for-readability">
<h3>Version 2 - <code class="docutils literal notranslate"><span class="pre">query</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">loc</span></code>, for readability<a class="headerlink" href="#version-2-query-loc-for-readability" title="Permalink to this headline">¶</a></h3>
<p>Same as V1, but step 1 uses <code class="docutils literal notranslate"><span class="pre">.query</span></code> to slice inside of <code class="docutils literal notranslate"><span class="pre">.loc</span></code></p>
<ol class="simple">
<li><p>save a slice of the dataset with the names we want (using <code class="docutils literal notranslate"><span class="pre">.query</span></code>)</p></li>
<li><p>sometimes a name is used by boys and girls in the same year, so combine the counts so that we have one observation per name per year</p></li>
<li><p>save the dataset and then call a plot function</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use query instead to slice, and the rest is the same</span>
<span class="n">somenames</span> <span class="o">=</span> <span class="n">baby_names</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;name in [&quot;Sansa&quot;,&quot;Daenerys&quot;,&quot;Brienne&quot;,&quot;Cersei&quot;,&quot;Tyrion&quot;] &amp; </span><span class="se">\</span>
<span class="s1">         year &gt;= 2000&#39;</span><span class="p">)</span> <span class="c1"># this is one string with &#39; as the string start/end symbol. Inside, I can use </span>
                        <span class="c1"># normal quote marks for strings. Also, I can break it into multiple lines with \</span>
<span class="n">somenames_agg</span> <span class="o">=</span> <span class="n">somenames</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">])[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">somenames_agg</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="c1"># add a line for when the show debuted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x2dd1e387bc8&gt;
</pre></div>
</div>
<img alt="../../_images/old 1_20_1.png" src="../../_images/old 1_20_1.png" />
</div>
</div>
</div>
<div class="section" id="version-3-method-chaining">
<h3>Version 3 - Method chaining!<a class="headerlink" href="#version-3-method-chaining" title="Permalink to this headline">¶</a></h3>
<p>Method chaining: Call the object (<code class="docutils literal notranslate"><span class="pre">baby_names</span></code>) and then keep calling one method on it after another.</p>
<ul class="simple">
<li><p>Python will call the methods from left to right.</p></li>
<li><p>There is no need to store the intermediate dataset (like <code class="docutils literal notranslate"><span class="pre">somenames</span></code> and <code class="docutils literal notranslate"><span class="pre">somenames_agg</span></code> above!)</p>
<ul>
<li><p>–&gt; Easier to read and write without “temp” objects all over the place</p></li>
<li><p>You can always save the dataset at an intermediate step if you need to</p></li>
</ul>
</li>
</ul>
<p>So, the first two steps are the same, just the methods will be chained. And then, a bonus trick to plot
without saving.</p>
<ol class="simple">
<li><p>Slice with <code class="docutils literal notranslate"><span class="pre">.query</span></code> to GoT-related names</p></li>
<li><p>Combine M and F gender counts if a name is used by both in the same year</p></li>
<li><p>Plot without saving: “Pipe” in the plotting function</p></li>
</ol>
<p>The code below produces a plot identical to V1 and V2, <strong>but it is unreadable. Don’t try - I’m about to make this readable!</strong> Just <em>one more</em> iteration…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">baby_names</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;name in [&quot;Sansa&quot;,&quot;Daenerys&quot;,&quot;Brienne&quot;,&quot;Cersei&quot;,&quot;Tyrion&quot;] &amp; year &gt;= 2000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">])[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">pipe</span><span class="p">((</span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="c1"># add a line for when the show debuted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x2dd1f726308&gt;
</pre></div>
</div>
<img alt="../../_images/old 1_22_1.png" src="../../_images/old 1_22_1.png" />
</div>
</div>
<p>To make this readable, we write a parentheses over multiple lines</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="ow">and</span> <span class="n">python</span> <span class="n">knows</span> <span class="n">to</span> <span class="n">execute</span> <span class="n">the</span> <span class="n">code</span> <span class="n">inside</span> <span class="k">as</span> <span class="n">one</span> <span class="n">line</span>
<span class="p">)</span>
</pre></div>
</div>
<p>And as a result, we can write a long series of methods that is comprehensible, and if we want we can even comment on each line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">baby_names</span>
      <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;name in [&quot;Sansa&quot;,&quot;Daenerys&quot;,&quot;Brienne&quot;,&quot;Cersei&quot;,&quot;Tyrion&quot;] &amp; </span><span class="se">\</span>
<span class="s1">         year &gt;= 2000&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">])[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># for each name-year, combine M and F counts</span>
      <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="c1"># give us the column names back as they were (makes the plot call easy)</span>
      <span class="o">.</span><span class="n">pipe</span><span class="p">((</span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="c1"># add a line for when the show debuted</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;WOW THAT WAS EASY TO WRITE AND SHARE&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;WOW THAT WAS EASY TO WRITE AND SHARE&#39;)
</pre></div>
</div>
<img alt="../../_images/old 1_24_1.png" src="../../_images/old 1_24_1.png" />
</div>
</div>
<p><strong>WOW. That’s nice code!</strong></p>
<p>Also: <strong>Naming your baby Daenerys after the hero…</strong></p>
<p>…is a bad break.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">baby_names</span>
      <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;name in [&quot;Khaleesi&quot;,&quot;Ramsay&quot;,&quot;Lyanna&quot;,&quot;Ellaria&quot;,&quot;Meera&quot;] &amp; </span><span class="se">\</span>
<span class="s1">         year &gt;= 2000&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">])[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># for each name-year, combine M and F counts</span>
      <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="c1"># give use the column names back as they were (makes the plot call easy)</span>
      <span class="o">.</span><span class="n">pipe</span><span class="p">((</span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="c1"># add a line for when the show debuted</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PEOPLE NAMED THEIR KID KHALEESI&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;PEOPLE NAMED THEIR KID KHALEESI&#39;)
</pre></div>
</div>
<img alt="../../_images/old 1_26_1.png" src="../../_images/old 1_26_1.png" />
</div>
</div>
<p><strong>BUT IT COULD BE WORSE</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">baby_names</span>
      <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;name in [&quot;Krymson&quot;] &amp; year &gt;= 1950&#39;</span><span class="p">)</span>
      <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">])[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># for each name-year, combine M and F counts</span>
      <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span> <span class="c1"># give use the column names back as they were (makes the plot call easy)</span>
      <span class="o">.</span><span class="n">pipe</span><span class="p">((</span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Alabama, wow...Krymson, really?&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Alabama, wow...Krymson, really?&#39;)
</pre></div>
</div>
<img alt="../../_images/old 1_28_1.png" src="../../_images/old 1_28_1.png" />
</div>
</div>
</div>
</div>
</div>
<div class="section" id="cookbook-and-best-practices-a-starter-kit">
<h1>Cookbook and best practices (a starter kit)<a class="headerlink" href="#cookbook-and-best-practices-a-starter-kit" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-analysis-steps-and-comments">
<h2>General analysis steps and comments<a class="headerlink" href="#general-analysis-steps-and-comments" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="#Essential-pandas:-Exploring-the-dataset">Start with the basic data exploration steps above</a></p>
<ul class="simple">
<li><p>variable names, types, count/missing, distributions</p></li>
</ul>
</li>
<li><p>Data cleaning:</p>
<ul class="simple">
<li><p>Do some variables have large outliers? You might need to winsorize or drop those observations.</p></li>
<li><p>Do some variables have many missing variables? Maybe there was a problem with the source or how you loaded it.</p></li>
<li><p>Do some variables have impossible values? For example, sales can’t be negative! Yet, some datasets use “-99” to indicate missing data. Or are there bad dates (June 31st)?</p></li>
<li><p>Are there duplicate observations (e.g. two 2001-GM observations because they changed their fiscal year in the middle of calendar year 2001?)</p></li>
<li><p>Are there missing observations or a gap in the time series (e.g. no observation in 2005 for Enron because the executive team was too “distracted to file its 10-K)</p></li>
<li><p>Do variables contradict each other? (E.g. If my birthday is 1/5/1999, then I must be 21 as of this writing.)</p></li>
</ul>
</li>
<li><p>Institutional knowledge is crucial.</p>
<ul class="simple">
<li><p>For example, in my research on firm investment policies and financing decisions (e.g. leverage), I drop any firms from the finance or utility industries. I know to do this because those industries are subject to several factors that fundamentally change their leverage in ways unrelated to their investment policies. Thus, including them would contaminate any relationships I find.</p></li>
<li><p>When we work with 10-K text data, we need to know what data tables are available and how to remove boilerplate.</p></li>
<li><p>You only get institutional through reading supporting materials, documentation, related info (research papers and WSJ, etc), and… the documents themselves. For example, I’ve read in excess of 6,000 proxy statements for a single research project. (If that sounds exciting: Go to grad school and become a prof!)</p></li>
</ul>
</li>
<li><p>Explore the data with your question in mind</p>
<ul class="simple">
<li><p>Compute statistics by subgroups (by age, or industry), or two-way (by gender and age)</p></li>
<li><p>This step reinforces institutional knowledge and understanding of the data</p></li>
<li><p><strong>Data exploration</strong> and <strong>data cleaning</strong> are interrelated and you’ll go back and forth from one to the other.</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="creating-summary-tables">
<h2>Creating summary tables<a class="headerlink" href="#creating-summary-tables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>A big part of the challenge is knowing what “cuts” of the data are interesting. You’ll figure this out as you get more knowledge in a specific area.</p></li>
<li><p>In tables that cut data based on two variables, how do you decide on the “second variable” to slice?</p>
<ol class="simple">
<li><p>Secondary slices might be on <em>a priori</em> (known in advance) interesting variables (“everyone talks about growth potential so I’ll also cut by that too because they will wonder about it if I don’t”)</p></li>
<li><p>Or, choose second variables because you think that the impact of the first variable will depend on the second variable. Suppose you divide firms into “young and old” as a first slice. Your second slice might be industries: perhaps leverage is only a little lower for older railroad firms but leverage is much higher for large firms in tech industries.</p></li>
<li><p>Another example: A common data science training dataset is about surviving the Titanic. Women survived at higher rates, but this is <strong>especially</strong> true in first class, where very few women died. The gender disparity was less severe in third class; while third class  men were more likely to perish than first class men, 45% of women in third class died, compared to ~0 in first class.</p></li>
</ol>
</li>
</ul>
<p><strong>Essential reading.</strong> Rather than me replicating these pages, read these after class, follow them, and save snippets of code you find useful to your growing cheat sheet.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.08-aggregation-and-grouping.html">Aggregation and grouping</a></p></li>
<li><p><a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.09-pivot-tables.html">Pivot tables</a></p></li>
</ul>
</div>
<div class="section" id="creating-summary-plots">
<h2>Creating summary plots<a class="headerlink" href="#creating-summary-plots" title="Permalink to this headline">¶</a></h2>
<p>Next week! But you’ll see a little plotting in the practice session. Speaking of which…</p>
</div>
</div>
<div class="section" id="time-to-practice">
<h1>Time to practice<a class="headerlink" href="#time-to-practice" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/LeDataSciFi/lectures-spr2020/tree/master/content/">Inside the Lecture repo</a>, go into the <code class="docutils literal notranslate"><span class="pre">02</span></code> subfolder and find the <code class="docutils literal notranslate"><span class="pre">02a-pandas-practice.ipynb</span></code> file and download it to your participation repo.</p>
<p>HINTS and supporting examples: See the links a few lines above this!</p>
</div>
<div class="section" id="before-next-class">
<h1>Before next class<a class="headerlink" href="#before-next-class" title="Permalink to this headline">¶</a></h1>
<ol class="simple">
<li><p>Finish and upload the numpy and pandas practice files to your participation repo.</p></li>
<li><p>Read the <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.08-aggregation-and-grouping.html">Aggregation and grouping</a> and <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.09-pivot-tables.html">Pivot tables</a> links</p></li>
<li><p>Peer reviews are due tomorrow and an assignment on Monday!</p></li>
</ol>
<p><img alt="" src="https://media.giphy.com/media/NzUjse8VQRTvG/giphy.gif" /></p>
</div>
<div class="section" id="credits">
<h1>Credits<a class="headerlink" href="#credits" title="Permalink to this headline">¶</a></h1>
<p>Here are some links I found that I liked. They cover many aspects of <code class="docutils literal notranslate"><span class="pre">panda</span></code>ing:</p>
<ol class="simple">
<li><p><a class="reference external" href="https://tomaugspurger.github.io/modern-1-intro">This covers indexing and slicing issues nicely</a></p></li>
<li><p><a class="reference external" href="https://stmorse.github.io/journal/tidyverse-style-pandas.html">This covers method chaining so that Python can approximate R’s elegance at data wrangling and plotting</a></p></li>
<li><p><a class="reference external" href="https://gist.github.com/conormm/fd8b1980c28dd21cfaf6975c86c74d07">This also has nice and quick examples showing Python matching R functions</a></p></li>
<li><p><a class="reference external" href="https://stackoverflow.com/questions/tagged/pandas?sort=votes&amp;pageSize=50">The most popular questions about <code class="docutils literal notranslate"><span class="pre">pandas</span></code> on Stackoverflow.</a> This will give you an idea of common places others get stuck, and slicing and indexing issues are high on the list.</p></li>
<li><p><a class="reference external" href="https://www.textbook.ds100.org">https://www.textbook.ds100.org</a></p></li>
</ol>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/03"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Prof. Donald Bowen<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            You're doing well, keep going!
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>